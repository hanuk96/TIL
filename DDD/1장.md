# 도메인 모델 시작하기
### 도메인 이란?
- 소프트웨어로 해결하고자하는 문제 영역을 "도메인"으로 정리한다.
- 도메인은 여러 하위 도메인으로 구성된다.

### 도메인 전문가와 개발자간 지식 공유
- 요구사항을 명확히 이해하기 위해 개발자와 전문가의 대화가 중요하다.
- garbage in garbage out
  1. 잘못된 값이 들어오면 잘못된 결과가 나온다는 뜻
  2. 전문가가 요구한 내용이 항상 올바른것은 아니며 진짜로 원하는것을 찾는 과정이 필
 
### 도메인 모델
- 특정 도메인을 개념적으로 표현한 것
- 하위 도메인과 모델
  1. 도메인은 여러 하위 도메인으로 구성된다.
  2. 한 도메인에 여러 하위 도메인을 모델링하면 안된다.
  3. 최종 모델의 각 구성요소는 특정 도메인으로 구성되어야 한다.
 
### 도메인 모델 패턴
|영역|설명|
|---|---|
|presentation|사용자 요청 처리, 정보 제공|
|application|사용자 요청 실행, 도메인을 조합|
|domain|도메인 규칙을 구현|
|infrastructure|데이터베이스, messaging 등 외부 시스템과의 연동 처리|

- 도메인 계층은 핵심 규칙을 구현한다.

```java
public class Order{
    private OrderState orderState;
    private ShippingInfo shippingInfo;
    
    public void changeShippingInfo(ShippingInfo shippingInfo){
        if(!isShippingInfoChangeable()){
            throw new IllegalStateException("출하지시 할수없는 상태입니다.");                    
        }
        this.shippingInfo = shippingInfo
    }
    
    private boolean isShippingInfoChangeable(){
        return orderState == OrderState.PAYMENT_WAITING || orderState == OrderState.PREPARING;
    }
}
public enum OrderState{
    PAYMENT_WAITING , PREPARING, SHIPPED, DELIVERING, DELIVERY_COMPLETED;
}
```
- 배송지 변경이 가능한지를 판단할 규칙은 주문 도메인 모델에서 구현해야 한다.
- 핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 확장, 수정시 영향도가 적어진다.

개념 모델 / 구현 모델
- 개념 모델은 순수하게 문제를 분석한 결과이다.
- 구현 모델은 db 트랜잭션, 성능 등을 고려하여 만든 구현체
- 그러므로 완벽한 개념 모델을 만들기보다는 전반적인 개요를 알 수 있는 수준으로 개념모델을 작성하여야 한다.

### 도메인 모델 도출
